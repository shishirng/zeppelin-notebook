{"paragraphs":[{"text":"import org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.{DataFrame, SparkSession}\n\n\nspark","user":"shishir","dateUpdated":"2017-07-11T14:39:58+0530","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1499746687246_-1790864430","id":"20170629-155408_1801119982","dateCreated":"2017-07-11T09:48:07+0530","dateStarted":"2017-07-11T14:39:58+0530","dateFinished":"2017-07-11T14:39:59+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:27194"},{"text":"val ds1 = spark\n        .readStream\n        .format(\"kafka\")\n        .option(\"kafka.bootstrap.servers\", \"10.144.102.121:9092,10.144.102.122:9092,10.144.102.123:9092,10.144.102.124:9092\")\n        .option(\"subscribe\",\"stream-1\")\n        .option(\"startingOffsets\", \"earliest\")\n        .load()\n","user":"shishir","dateUpdated":"2017-07-11T14:40:01+0530","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1499746687248_-1780860959","id":"20170629-155557_1371515017","dateCreated":"2017-07-11T09:48:07+0530","dateStarted":"2017-07-11T14:40:01+0530","dateFinished":"2017-07-11T14:40:01+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:27195"},{"text":"ds1.printSchema()","user":"shishir","dateUpdated":"2017-07-11T14:40:04+0530","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1499746687255_-1782015205","id":"20170630-122320_1702752924","dateCreated":"2017-07-11T09:48:07+0530","dateStarted":"2017-07-11T14:40:04+0530","dateFinished":"2017-07-11T14:40:04+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:27196"},{"text":"val values = ds1.select(\"value\").as[String]","user":"shishir","dateUpdated":"2017-07-11T14:40:09+0530","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1499750082010_-1933654781","id":"20170711-104442_347102243","dateCreated":"2017-07-11T10:44:42+0530","dateStarted":"2017-07-11T14:40:09+0530","dateFinished":"2017-07-11T14:40:09+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:27197"},{"text":"var streamingSelectorDF = ds1.select(get_json_object(($\"value\").cast(\"string\"), \"$.mobile\").alias(\"usermobile\")).groupBy($\"usermobile\").count()\nprint(streamingSelectorDF)","user":"shishir","dateUpdated":"2017-07-11T14:41:44+0530","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1499750129171_1533378855","id":"20170711-104529_772892205","dateCreated":"2017-07-11T10:45:29+0530","dateStarted":"2017-07-11T14:41:44+0530","dateFinished":"2017-07-11T14:41:44+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:27198"},{"text":"\nimport org.apache.spark.sql.streaming.ProcessingTime\nval t= streamingSelectorDF.writeStream.outputMode(\"update\")\n  .format(\"console\")\n  .trigger(ProcessingTime(\"5 seconds\"))\n  .start()\n\nt.awaitTermination()\n","user":"shishir","dateUpdated":"2017-07-11T14:58:06+0530","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1499748470009_1652980815","id":"20170711-101750_947495723","dateCreated":"2017-07-11T10:17:50+0530","dateStarted":"2017-07-11T14:58:06+0530","dateFinished":"2017-07-11T14:58:31+0530","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:27199"},{"text":"","user":"shishir","dateUpdated":"2017-07-11T10:59:57+0530","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1499748650279_-2083671499","id":"20170711-102050_709206376","dateCreated":"2017-07-11T10:20:50+0530","dateStarted":"2017-07-11T10:47:41+0530","dateFinished":"2017-07-11T10:47:41+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:27200"},{"text":"val query = wordCounts.writeStream.outputMode(\"complete\").format(\"console\").start()","user":"shishir","dateUpdated":"2017-07-11T10:47:38+0530","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1499748815162_-1729070931","id":"20170711-102335_1726855819","dateCreated":"2017-07-11T10:23:35+0530","dateStarted":"2017-07-11T10:47:41+0530","dateFinished":"2017-07-11T10:47:42+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:27201"},{"text":"","user":"shishir","dateUpdated":"2017-07-11T10:47:38+0530","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1499748869689_-1398663571","id":"20170711-102429_469139346","dateCreated":"2017-07-11T10:24:29+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:27202"},{"user":"shishir","dateUpdated":"2017-07-11T10:47:38+0530","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1499748886177_933714910","id":"20170711-102446_1709608461","dateCreated":"2017-07-11T10:24:46+0530","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:27203"}],"name":"shishir/dataframe_streaming_kafka","id":"2CPAXEPW3","angularObjects":{"2CNVS5U8X:shared_process":[],"2CN1TRFBR:shared_process":[],"2CM9U7URG:shared_process":[],"2CKHFE2XU:shared_process":[],"2CM72452H:shared_process":[],"2CK7RH8CJ:shared_process":[],"2CPM66JHM:shared_process":[],"2CPDJNF8C:shared_process":[],"2CME5RDA7:shared_process":[],"2CNHVHD2B:shared_process":[],"2CNG67346:shared_process":[],"2CKAU58Y6:shared_process":[],"2CMXD98EU:shared_process":[],"2CK96X57D:shared_process":[],"2CPBSZP9P:shared_process":[],"2CKYN37H8:shared_process":[],"2CNJDHEZG:shared_process":[],"2CKZ22DX4:shared_process":[],"2CMCS4YVB:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}