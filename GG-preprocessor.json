{"paragraphs":[{"text":"import spark.implicits._\nspark\nval sqlDF = sqlContext.read.json(\"hdfs://namenode:8020/GG_sample.json\")\nsqlDF.printSchema\nsqlDF.show","user":"shishir","dateUpdated":"2017-07-20T17:56:48+0530","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1500531657114_-849021274","id":"20170720-115057_188150452","dateCreated":"2017-07-20T11:50:57+0530","dateStarted":"2017-07-20T17:56:48+0530","dateFinished":"2017-07-20T17:57:02+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:28725"},{"text":"import org.apache.spark.sql.functions.year\nimport org.apache.spark.sql._\n\nval tmptable = sqlDF.select(\"table\").take(1).mkString\nprint(tmptable)\nval table = tmptable.filter(_ != '[').filter(_ != ']')\nval tmp = sqlDF\n  .withColumn(\"op_ts\", $\"op_ts\".cast(\"timestamp\"))  // cast to timestamp\n  .withColumn(\"year\", year($\"op_ts\"))\n  .withColumn(\"month\", month($\"op_ts\"))\n  .withColumn(\"day\", dayofmonth($\"op_ts\"))\n  .withColumn(\"unix_ts\", unix_timestamp($\"op_ts\",\"YYYY-MM-DD HH:MM:ss.SSSSSS\"))\n  .drop(\"current_ts\")\n  .drop(\"pos\")\n  .withColumn(\"before_ID\", col(\"before.ID\"))\n  .withColumn(\"before_FIRSTNAME\", col(\"before.FIRSTNAME\"))\n  .withColumn(\"before_BIRTHDAY\", col(\"before.BIRTHDAY\"))\n  .drop(\"before\")\n  .withColumn(\"after_ID\", col(\"after.ID\"))\n  .withColumn(\"after_FIRSTNAME\", col(\"after.FIRSTNAME\"))\n  .withColumn(\"after_BIRTHDAY\", col(\"after.BIRTHDAY\"))\n  .drop(\"after\")\n  .drop(\"table\")\n  .drop(\"hour\")\n  //.withColumn(\"Hour\", hour($\"op_ts\"))\n  //.withColumn(\"minutes\", minute($\"op_ts\"))\n  //.withColumn(\"seconds\", second($\"op_ts\"))\n \n tmp.show","user":"shishir","dateUpdated":"2017-07-20T17:40:59+0530","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1500534824135_-1515489568","id":"20170720-124344_839821283","dateCreated":"2017-07-20T12:43:44+0530","dateStarted":"2017-07-20T17:41:00+0530","dateFinished":"2017-07-20T17:41:24+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:28726"},{"text":"tmp.filter($\"op_type\" === \"U\").show","user":"shishir","dateUpdated":"2017-07-20T17:41:12+0530","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1500542721505_371500981","id":"20170720-145521_249801297","dateCreated":"2017-07-20T14:55:21+0530","dateStarted":"2017-07-20T17:41:12+0530","dateFinished":"2017-07-20T17:41:26+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:28727"},{"text":"tmp.createOrReplaceTempView(\"GG_tmp\")\n\nvar day18 = spark.sql(\"SELECT * from GG_tmp where year='2017' AND month='7' AND day='18'\").drop(\"year\").drop(\"month\").drop(\"day\").drop(\"hour\")\nday18.show","user":"shishir","dateUpdated":"2017-07-20T17:57:58+0530","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1500542843534_-1749434171","id":"20170720-145723_945704587","dateCreated":"2017-07-20T14:57:23+0530","dateStarted":"2017-07-20T17:57:58+0530","dateFinished":"2017-07-20T17:58:04+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:28728"},{"text":"val path=\"hdfs://namenode:8020/tmp/test/\"+table+\"/2017/07/18/processed.parquet\"\nday18.write.parquet(path)\n","user":"shishir","dateUpdated":"2017-07-20T17:58:10+0530","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1500545340452_180419218","id":"20170720-153900_1507845325","dateCreated":"2017-07-20T15:39:00+0530","dateStarted":"2017-07-20T17:58:10+0530","dateFinished":"2017-07-20T17:58:14+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:28729"},{"text":"val parDF = sqlContext.read.parquet(path)\nparDF.printSchema\nparDF.show\n\n//spark.sql(\"SELECT after_FIRSTNAME FROM GG_tmp WHERE op_type ='I'\").show\n","user":"shishir","dateUpdated":"2017-07-20T17:58:19+0530","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1500540587018_2123429121","id":"20170720-141947_2120940259","dateCreated":"2017-07-20T14:19:47+0530","dateStarted":"2017-07-20T17:58:19+0530","dateFinished":"2017-07-20T17:58:27+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:28730"},{"text":"val dates = tmp.select(\"year\",\"month\", \"day\").distinct\ndates.show\n","user":"shishir","dateUpdated":"2017-07-20T18:12:58+0530","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1500542393598_-956691093","id":"20170720-144953_1826799329","dateCreated":"2017-07-20T14:49:53+0530","dateStarted":"2017-07-20T18:12:58+0530","dateFinished":"2017-07-20T18:13:03+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:28731"},{"text":"//dates.createOrReplaceTempView(\"dates\")\nval dates1 = tmp.select(concat($\"year\",lit(\"/\"),$\"month\",lit(\"/\"),$\"day\")).distinct\ndates1.show\n\n//spark.sql(\"SELECT \")\n","user":"shishir","dateUpdated":"2017-07-20T18:18:57+0530","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1500553552558_701137648","id":"20170720-175552_53981218","dateCreated":"2017-07-20T17:55:52+0530","dateStarted":"2017-07-20T18:18:57+0530","dateFinished":"2017-07-20T18:19:04+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:28732"},{"user":"shishir","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1500554705547_978835381","id":"20170720-181505_1107984799","dateCreated":"2017-07-20T18:15:05+0530","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:28733"}],"name":"/shishir/GG-PreProcessor","id":"2CN6HZ8UD","angularObjects":{"2CNVS5U8X:shared_process":[],"2CN1TRFBR:shared_process":[],"2CM9U7URG:shared_process":[],"2CKHFE2XU:shared_process":[],"2CM72452H:shared_process":[],"2CK7RH8CJ:shared_process":[],"2CPM66JHM:shared_process":[],"2CPDJNF8C:shared_process":[],"2CME5RDA7:shared_process":[],"2CNHVHD2B:shared_process":[],"2CNG67346:shared_process":[],"2CKAU58Y6:shared_process":[],"2CMXD98EU:shared_process":[],"2CK96X57D:shared_process":[],"2CPBSZP9P:shared_process":[],"2CKYN37H8:shared_process":[],"2CNJDHEZG:shared_process":[],"2CKZ22DX4:shared_process":[],"2CMCS4YVB:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}