{"paragraphs":[{"text":"spark","user":"shishir","dateUpdated":"2017-07-25T10:07:59+0530","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nres12: org.apache.spark.sql.SparkSession = org.apache.spark.sql.SparkSession@2f0c819b\n"}]},"apps":[],"jobName":"paragraph_1500957396399_-1153756027","id":"20170724-103900_1898933417","dateCreated":"2017-07-25T10:06:36+0530","dateStarted":"2017-07-25T10:07:59+0530","dateFinished":"2017-07-25T10:07:59+0530","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:19290"},{"text":"import org.apache.spark.sql.catalyst.ScalaReflection\nimport org.apache.spark.sql.{DataFrame, SQLContext, SaveMode, SparkSession}\nimport org.apache.spark.sql.types._\n\ncase class ApsalarEventReport(TimeStamp: Integer, IP: String, Platform: String, LongName: String, SDK: String, DeviceId: String, SessionId: String, Name: String, Arguments: String, IDFA: String, DeviceIdKeySpace: String)\n\nval schema = ScalaReflection.schemaFor[ApsalarEventReport].dataType.asInstanceOf[StructType]","user":"shishir","dateUpdated":"2017-07-25T10:25:29+0530","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.sql.catalyst.ScalaReflection\n\nimport org.apache.spark.sql.{DataFrame, SQLContext, SaveMode, SparkSession}\n\nimport org.apache.spark.sql.types._\n\ndefined class ApsalarEventReport\n\nschema: org.apache.spark.sql.types.StructType = StructType(StructField(TimeStamp,IntegerType,true), StructField(IP,StringType,true), StructField(Platform,StringType,true), StructField(LongName,StringType,true), StructField(SDK,StringType,true), StructField(DeviceId,StringType,true), StructField(SessionId,StringType,true), StructField(Name,StringType,true), StructField(Arguments,StringType,true), StructField(IDFA,StringType,true), StructField(DeviceIdKeySpace,StringType,true))\n"}]},"apps":[],"jobName":"paragraph_1500957396403_-1142983058","id":"20170724-104846_1209972258","dateCreated":"2017-07-25T10:06:36+0530","dateStarted":"2017-07-25T10:25:29+0530","dateFinished":"2017-07-25T10:25:31+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:19291"},{"text":"import org.apache.spark.sql.functions.year\nimport org.apache.spark.sql._\nimport spark.implicits._\nimport org.apache.spark.sql.functions.month","user":"shishir","dateUpdated":"2017-07-25T10:25:34+0530","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.sql.functions.year\n\nimport org.apache.spark.sql._\n\nimport spark.implicits._\n\nimport org.apache.spark.sql.functions.month\n"}]},"apps":[],"jobName":"paragraph_1500957396405_-1145291551","id":"20170725-090341_342848252","dateCreated":"2017-07-25T10:06:36+0530","dateStarted":"2017-07-25T10:25:34+0530","dateFinished":"2017-07-25T10:25:36+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:19292"},{"text":"var input: String = \"hdfs:///apsalar/dump/Events/20170401.csv.bz2\"\nval eventDF = spark.read.schema(schema).option(\"header\",true).csv(input).toDF\n\neventDF.printSchema\neventDF.show","user":"shishir","dateUpdated":"2017-07-25T10:25:38+0530","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ninput: String = hdfs:///apsalar/dump/Events/20170401.csv.bz2\n\neventDF: org.apache.spark.sql.DataFrame = [TimeStamp: int, IP: string ... 9 more fields]\nroot\n |-- TimeStamp: integer (nullable = true)\n |-- IP: string (nullable = true)\n |-- Platform: string (nullable = true)\n |-- LongName: string (nullable = true)\n |-- SDK: string (nullable = true)\n |-- DeviceId: string (nullable = true)\n |-- SessionId: string (nullable = true)\n |-- Name: string (nullable = true)\n |-- Arguments: string (nullable = true)\n |-- IDFA: string (nullable = true)\n |-- DeviceIdKeySpace: string (nullable = true)\n\n+----------+---------------+--------+------------------+---------------+--------------------+--------------------+----------------+--------------------+--------------------+--------------------+\n| TimeStamp|             IP|Platform|          LongName|            SDK|            DeviceId|           SessionId|            Name|           Arguments|                IDFA|    DeviceIdKeySpace|\n+----------+---------------+--------+------------------+---------------+--------------------+--------------------+----------------+--------------------+--------------------+--------------------+\n|1490954131|   47.247.0.142|     iOS|  com.jio.jiomoney|  Apsalar/7.2.1|C8A95153-3181-4E1...|1F7297A5-DD54-413...|      APP_OPENED|                  {}|C8A95153-3181-4E1...|                IDFA|\n|1490954132|   47.11.129.49| Android|com.corpay.mwallet|Apsalar/6.6-SSL|0a07d207-0bb9-42b...|bb5f66bd-824c-467...|     Home_Screen|\"{\"\"Key\"\":\"\"11646...|0a07d207-0bb9-42b...|                AIFA|\n|1490954133|    49.34.7.242| Android|com.corpay.mwallet|Apsalar/6.6-SSL|d0d8b765-89ec-4d2...|f56bbfc3-f33d-4ee...|   JioPrime_Join|\"{\"\"Key\"\":\"\"11523...|d0d8b765-89ec-4d2...|                AIFA|\n|1490954133|     47.9.9.240|     iOS|  com.jio.jiomoney|  Apsalar/7.2.1|6017FA90-01FE-432...|52D9F5AA-EA8C-460...|      App_Opened|\"{\"\"CustomerID\"\":...|6017FA90-01FE-432...|                IDFA|\n|1490954133|     47.15.9.67| Android|com.corpay.mwallet|Apsalar/6.6-SSL|66221e8c-2d21-42d...|0c48c6a3-0dc1-4e6...|     Home_Screen|\"{\"\"Key\"\":\"\"11256...|66221e8c-2d21-42d...|                AIFA|\n|1490954133|   47.9.132.228| Android|com.corpay.mwallet|Apsalar/6.6-SSL|24e2b58d-26dd-4e7...|db45b5d4-b87f-4fd...|     Home_Screen|\"{\"\"Key\"\":\"\"11605...|24e2b58d-26dd-4e7...|                AIFA|\n|1490953416|   47.29.22.154| Android|com.corpay.mwallet|Apsalar/6.6-SSL|68ed3f0e-9271-49d...|b57c5261-1af6-4a4...|   JioPrime_Join|\"{\"\"Key\"\":\"\"11023...|68ed3f0e-9271-49d...|                AIFA|\n|1490954132|   47.15.12.100| Android|com.corpay.mwallet|Apsalar/6.6-SSL|c9eea808-f178-421...|f9fd737e-8458-42c...|     Home_Screen|\"{\"\"Key\"\":\"\"11434...|c9eea808-f178-421...|                AIFA|\n|1490954134|    157.48.3.20| Android|com.corpay.mwallet|Apsalar/6.6-SSL|9d5b0865-4e56-4a1...|9fa9504c-c003-4b7...|   JioPrime_Join|\"{\"\"Key\"\":\"\"11673...|9d5b0865-4e56-4a1...|                AIFA|\n|1490954134|169.149.135.227| Android|com.corpay.mwallet|Apsalar/6.6-SSL|51d5f81b-5976-451...|b7628bf6-e435-496...|   JioPrime_Join|\"{\"\"Key\"\":\"\"11673...|51d5f81b-5976-451...|                AIFA|\n|1490954134|    49.35.13.73| Android|com.corpay.mwallet|Apsalar/6.6-SSL|65129072-6551-4a5...|3bd5c70e-41f5-448...|     Home_Screen|\"{\"\"Key\"\":\"\"11247...|65129072-6551-4a5...|                AIFA|\n|1490954134|     49.35.6.71| Android|com.corpay.mwallet|Apsalar/6.6-SSL|7edbb1a3-47e3-486...|6ad41a09-cd0e-434...|     Home_Screen|\"{\"\"Key\"\":\"\"11438...|7edbb1a3-47e3-486...|                AIFA|\n|1490973382|    47.9.135.73| Android|com.corpay.mwallet|Apsalar/6.6-SSL|a0e6150f-a188-47f...|2f744d2a-7a63-4d1...|     Home_Screen|\"{\"\"Key\"\":\"\"11382...|a0e6150f-a188-47f...|                AIFA|\n|1491029641|   169.149.6.25| Android|com.corpay.mwallet|Apsalar/6.6-SSL|68a24a1a-0da6-412...|a6464586-f478-4ea...|   JioPrime_Join|\"{\"\"Key\"\":\"\"11669...|68a24a1a-0da6-412...|                AIFA|\n|1491029640|    27.62.94.32| Android|com.corpay.mwallet|Apsalar/6.6-SSL|10a6a188-7b6a-42a...|a2fc1170-2d30-43e...|     Home_Screen|\"{\"\"Key\"\":\"\"11662...|10a6a188-7b6a-42a...|                AIFA|\n|1491029645|    49.34.7.117| Android|com.corpay.mwallet|Apsalar/6.6-SSL|5b3ae4c3-2683-435...|f9c611f6-3339-474...|   JioPrime_Join|\"{\"\"Key\"\":\"\"11671...|5b3ae4c3-2683-435...|                AIFA|\n|1491029644|   49.44.51.128| Android|com.corpay.mwallet|Apsalar/6.6-SSL|4ed35f70-88ce-442...|bf888dc5-911a-4f7...|     Home_Screen|\"{\"\"Key\"\":\"\"11288...|4ed35f70-88ce-442...|                AIFA|\n|1491029646|103.239.171.204|     iOS|  com.jio.jiomoney|  Apsalar/7.2.1|9EDF6B83-3DFE-44A...|2B581211-ED6C-4E8...|      App_Opened|\"{\"\"CustomerID\"\":...|9EDF6B83-3DFE-44A...|                IDFA|\n|1491029646|  139.167.4.163| Android|com.corpay.mwallet|Apsalar/6.6-SSL|6cdbfe62-3787-454...|de65c694-e517-462...|Recharge_Prepaid|    \"{\"\"Amount\"\":100|\"\"Key\"\":\"\"1153084...|\"\"customer_timest...|\n|1491029646|     49.34.2.46| Android|com.corpay.mwallet|Apsalar/6.6-SSL|652a8207-016c-465...|bc9f09cb-57df-48a...|     Home_Screen|\"{\"\"Key\"\":\"\"11082...|652a8207-016c-465...|                AIFA|\n+----------+---------------+--------+------------------+---------------+--------------------+--------------------+----------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1500957452069_411310553","id":"20170725-100732_1229791484","dateCreated":"2017-07-25T10:07:32+0530","dateStarted":"2017-07-25T10:25:38+0530","dateFinished":"2017-07-25T10:25:40+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:19293"},{"text":"\nvar input: String = \"hdfs:///apsalar/dump/Events/\"\nprintln(input);\nval attrDF = spark.read.schema(schema).option(\"header\", true).csv(input).toDF\nval storeDF = attrDF\n            .withColumn(\"TimeStamp\", $\"TimeStamp\".cast(\"timestamp\"))\n            .withColumn(\"year\", year($\"TimeStamp\"))\n            .withColumn(\"day\", dayofmonth($\"TimeStamp\"))\n            .withColumn(\"month\", month($\"TimeStamp\"))\nvar output:String = \"hdfs:///apsalar/processed/Events/\"\n\nprintln(output);\nstoreDF.write.partitionBy(\"year\",\"month\",\"day\").mode(SaveMode.Append).parquet(output)\n\n","user":"shishir","dateUpdated":"2017-07-25T10:26:35+0530","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1500957396407_-1144522053","id":"20170724-172149_712281810","dateCreated":"2017-07-25T10:06:36+0530","dateStarted":"2017-07-25T10:26:35+0530","dateFinished":"2017-07-25T10:26:18+0530","status":"RUNNING","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19294"},{"text":"//import  org.apache.hadoop.fs.{FileSystem,Path}\n\n//FileSystem.get( sc.hadoopConfiguration ).listStatus( new Path(\"hdfs:///apsalar/Attribution/\")).foreach( x => println(x.getPath ))\n","dateUpdated":"2017-07-25T10:06:36+0530","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1500957396409_-1146830547","id":"20170724-172408_1690906444","dateCreated":"2017-07-25T10:06:36+0530","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19295"},{"dateUpdated":"2017-07-25T10:06:36+0530","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1500957396411_-1146061049","id":"20170724-183745_1962584625","dateCreated":"2017-07-25T10:06:36+0530","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19296"}],"name":"/shishir/apsalar-events","id":"2CN16BGJX","angularObjects":{"2CNVS5U8X:shared_process":[],"2CN1TRFBR:shared_process":[],"2CM9U7URG:shared_process":[],"2CKHFE2XU:shared_process":[],"2CM72452H:shared_process":[],"2CK7RH8CJ:shared_process":[],"2CPM66JHM:shared_process":[],"2CPDJNF8C:shared_process":[],"2CME5RDA7:shared_process":[],"2CNHVHD2B:shared_process":[],"2CNG67346:shared_process":[],"2CKAU58Y6:shared_process":[],"2CMXD98EU:shared_process":[],"2CK96X57D:shared_process":[],"2CPBSZP9P:shared_process":[],"2CKYN37H8:shared_process":[],"2CNJDHEZG:shared_process":[],"2CKZ22DX4:shared_process":[],"2CMCS4YVB:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}