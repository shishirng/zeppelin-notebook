{"paragraphs":[{"text":"spark","user":"shishir","dateUpdated":"2017-07-25T09:57:14+0530","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1500872940646_626774036","id":"20170724-103900_1898933417","dateCreated":"2017-07-24T10:39:00+0530","dateStarted":"2017-07-25T09:57:14+0530","dateFinished":"2017-07-25T09:57:54+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:98"},{"text":"import org.apache.spark.sql.catalyst.ScalaReflection\nimport org.apache.spark.sql.{DataFrame, SQLContext, SaveMode, SparkSession}\nimport org.apache.spark.sql.types._\n\ncase class ApsalarDeviceExport(KeySpace: String, DeviceId: String, CampaignName: String, CampaignGroup: String, CampaignSource: String, Country: String, ClickTs: String, InstallTs: String, PricingModel: String, Price: String, SourceApp: String, Creative: String, LongName: String, Attribution: String, IDFV: String, State: String, City: String, Manufacturer: String, Model: String, OS: String, Carrier: String, ConversionType: String, FingerPrint: String, AppStoreFlag: String, InstallerSource: String)\n\n\nval schema = ScalaReflection.schemaFor[ApsalarDeviceExport].dataType.asInstanceOf[StructType]","user":"shishir","dateUpdated":"2017-07-25T10:05:37+0530","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1500873526131_-976756749","id":"20170724-104846_1209972258","dateCreated":"2017-07-24T10:48:46+0530","dateStarted":"2017-07-25T09:58:49+0530","dateFinished":"2017-07-25T09:58:51+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:99"},{"text":"import org.apache.spark.sql.functions.year\nimport org.apache.spark.sql._\nimport spark.implicits._\nimport org.apache.spark.sql.functions.month","user":"shishir","dateUpdated":"2017-07-25T10:05:46+0530","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1500953621830_-1974480902","id":"20170725-090341_342848252","dateCreated":"2017-07-25T09:03:41+0530","dateStarted":"2017-07-25T09:58:57+0530","dateFinished":"2017-07-25T09:58:58+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100"},{"text":"\nvar input: String = \"hdfs:///apsalar/dump/Attribution/\"\nprintln(input);\nval attrDF = spark.read.schema(schema).option(\"header\", false).csv(input).toDF\nval storeDF = attrDF\n                .withColumn(\"ClickTs\", $\"ClickTs\".cast(\"timestamp\"))\n                .withColumn(\"year\", year($\"ClickTs\"))\n                .withColumn(\"day\", dayofmonth($\"ClickTs\"))\n                .withColumn(\"month\", month($\"ClickTs\"))\nvar output:String = \"hdfs:///apsalar/processed/Attribution/\"\n\nprintln(output);\nstoreDF.write.partitionBy(\"year\",\"month\",\"day\").mode(SaveMode.Append).parquet(output)\n\n","user":"shishir","dateUpdated":"2017-07-25T10:05:12+0530","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1500897109566_-1120500111","id":"20170724-172149_712281810","dateCreated":"2017-07-24T17:21:49+0530","dateStarted":"2017-07-25T09:59:06+0530","dateFinished":"2017-07-25T10:02:25+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101"},{"text":"//import  org.apache.hadoop.fs.{FileSystem,Path}\n\n//FileSystem.get( sc.hadoopConfiguration ).listStatus( new Path(\"hdfs:///apsalar/Attribution/\")).foreach( x => println(x.getPath ))\n","user":"shishir","dateUpdated":"2017-07-25T10:05:57+0530","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1500897248597_-802096588","id":"20170724-172408_1690906444","dateCreated":"2017-07-24T17:24:08+0530","dateStarted":"2017-07-24T18:39:54+0530","dateFinished":"2017-07-24T18:39:56+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:102"},{"user":"shishir","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1500901665554_-1022092002","id":"20170724-183745_1962584625","dateCreated":"2017-07-24T18:37:45+0530","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:103"}],"name":"/shishir/apsalar-attributions","id":"2CPDG83RD","angularObjects":{"2CNVS5U8X:shared_process":[],"2CN1TRFBR:shared_process":[],"2CM9U7URG:shared_process":[],"2CKHFE2XU:shared_process":[],"2CM72452H:shared_process":[],"2CK7RH8CJ:shared_process":[],"2CPM66JHM:shared_process":[],"2CPDJNF8C:shared_process":[],"2CME5RDA7:shared_process":[],"2CNHVHD2B:shared_process":[],"2CNG67346:shared_process":[],"2CKAU58Y6:shared_process":[],"2CMXD98EU:shared_process":[],"2CK96X57D:shared_process":[],"2CPBSZP9P:shared_process":[],"2CKYN37H8:shared_process":[],"2CNJDHEZG:shared_process":[],"2CKZ22DX4:shared_process":[],"2CMCS4YVB:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}